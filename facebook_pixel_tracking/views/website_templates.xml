<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="facebook_pixel_layout" name="Main layout" inherit_id="portal.frontend_layout">
        <xpath expr="//div[@id='wrapwrap']" position="after">
            <!-- Facebook Pixel Code -->
            <script t-if="website and website.facebook_pixel_key">
!function(f,b,e,v,n,t,s)
                {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                n.callMethod.apply(n,arguments):n.queue.push(arguments)};
                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
                n.queue=[];t=b.createElement(e);t.async=!0;
                t.src=v;s=b.getElementsByTagName(e)[0];
                s.parentNode.insertBefore(t,s)}(window, document,'script',
                'https://connect.facebook.net/en_US/fbevents.js');
fbq('init', '<t t-esc="website.facebook_pixel_key"/>'.trim());
fbq('track', 'PageView');
const url = window.location.pathname;
var formation = null;
//set pack
switch (true) {
  case url.includes('solo'):
    formation = 'solo';
    break;
  case url.includes('pro'):
    formation = 'pro';
    break;
  case url.includes('premuim'):
    formation = 'premuim';
    break;

  default:
    break;
}
//set suitable tracker for each url
switch (true) {
  case url.includes('/felicitations'):
    fbq('track', 'CompleteRegistration', {
      pack: formation,
      url: window.location.pathname,
    });
    break;
  case url.includes('/shop/cart'):
               
    fbq('trackCustom', 'Documents chargés', {
      pack: formation,
      url: window.location.pathname,
    });
  default:
    break;
}
// fbq('trackCustom', 'Inscription terminée', {
//   pack: formation,
//   url:'/felicitations'
// });

            </script>
            <noscript t-if="website and website.facebook_pixel_key">
                <img height="1" width="1" style="display:none"
                     t-att-src="'https://www.facebook.com/tr?id=%s&amp;ev=PageView&amp;noscript=1' % (website.facebook_pixel_key or '')"
                />
            </noscript>
            <!-- End Facebook Pixel Code -->
            <!-- Cookies Integration Script START -->
<!--            <script>-->
<!--                var void0= false;-->
<!--                void0 === window._axcb &amp;&amp; (window._axcb=[]);-->
<!--                window._axcb.push(function(axeptio) {-->
<!--                axeptio.on("cookies:complete", function(choices) {-->
<!--                })-->
<!--                })-->
<!--            </script>-->
            <!-- Cookies Integration Script END -->
        </xpath>
    </template>
</odoo>
